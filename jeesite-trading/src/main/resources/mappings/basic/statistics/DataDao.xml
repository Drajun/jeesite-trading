<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jeesite.modules.basic.statistics.dao.DataDao">
	
	<resultMap type="com.jeesite.modules.basic.statistics.entity.Data" id="dataRM">
		<result property="data" column="data"/>
		<result property="datetime" column="datetime"/>
	</resultMap>
	
	<!-- 根据月份查付款金额 -->
	<select id="statisticsPayByMonth" parameterType="string" resultMap="dataRM">
		select sum(`actual_amount`) as data, DATE_FORMAT(create_date,'%m') as datetime
		from paybill_f 
		where date_format(create_date,'%Y-%m') = DATE_FORMAT(#{date},'%Y-%m')
		group by month(create_date);
	</select>
	
	<!-- 根据年份查询销售额 -->
	<select id="statisticsSalesByYear" parameterType="string" resultMap="dataRM">
		select sum(`total_amount`) as data, DATE_FORMAT(create_date,'%m') as datetime
		from contract_c 
		where date_format(create_date,'%Y') = DATE_FORMAT(#{date},'%Y')
		group by month(create_date);
	</select>
	
	<!-- 根据年份统计成本 -->
	<select id="statisticsCostByYear" parameterType="string" resultMap="dataRM">
		select sum(`total_cost`) as data, DATE_FORMAT(record_date,'%m') as datetime
		from cost 
		where date_format(record_date,'%Y') = DATE_FORMAT(#{date},'%Y')
		group by month(record_date);
	</select>
	
	<!-- 根据年份统计收益 -->
	<select id="statisticsBenefitsByYear" parameterType="string" resultMap="dataRM">
		select sum(`actual_amount`) as data, DATE_FORMAT(rebill_time,'%m') as datetime
		from rebill_f 
		where date_format(rebill_time,'%Y') = DATE_FORMAT(#{date},'%Y')
		group by month(rebill_time);
	</select>
</mapper>